# os  

orange os 读书笔记  

## 启动过程  

- PC 一般一个扇区是512字节  

1. bios 检查软盘0面0磁道1扇区，若以`0xAA55`结尾，则认为是引导扇区  
2. bios 将此512 扇区内容装载到`0000:7c00`处，然后跳转到此处，将控制权交给引导程序  

*这也是为什么要有`org 07c00h`的原因：此命令告诉编译器这段程序要被加载到`07c00h`处*  

## nasm宏命令  

- nasm 编译的机器指令一般是四字节(32 位)对齐的，因为cpu 读取指令时一般是四字节读取，会比较快  
- `[]` 不被`[]`括起的标签或变量名都是地址  

```nasm
foo:
    dw 1        ; 定义标签foo
; foo dw 1      ; 定义变量foo，二者等价
mov ax, foo     ; 将foo 的地址传递给ax
mov ax, [foo]   ; 将1 传递给ax
```  

- `$` 表示当前行地址，`$$` 表示当前节(section)起始的地址  

```nasm
section a aligin=b vstart=c
; a 段名
; b 对齐字节数，默认为4字节，如果段的长度不是4 字节的倍数，则会用00填充
; c 段内汇编地址的开始点，该段内的汇编地址都是从vstart 开始计算的
```

- `times count db 0` 重复count 次db 0  
